---
name: Generate-structured action returns strings instead of structured data
status: active
created: 2025-08-21T21:16:19Z
updated: 2025-08-21T21:16:19Z
github: https://github.com/ContextLab/orchestrator/issues/222
imported: true
labels: bug, enhancement
---

# Generate-structured action returns strings instead of structured data

**GitHub Issue:** [#222](https://github.com/ContextLab/orchestrator/issues/222)
**Status:** OPEN
**Labels:** bug, enhancement

## Description

## Problem
The `generate-structured` action returns string responses instead of properly structured data objects, making it impossible to access fields like `extract_claims.claims` or `extract_claims.total_claims` in subsequent pipeline steps.

## Evidence
From iterative_fact_checker pipeline execution:
1. `extract_claims` step returns a string containing JSON and markdown
2. Template references like `{{ extract_claims.claims }}` fail
3. Subsequent steps receive `'str object' has no attribute 'claims'` errors

## Impact
- Cannot iterate over extracted data structures
- Cannot access nested fields in results
- Forces workarounds or pipeline redesign
- Breaks expected data flow in pipelines

## Expected Behavior
`generate-structured` with a schema should return:
- A proper data structure matching the schema
- Fields accessible via dot notation in templates
- Arrays that can be iterated with `for_each` or template loops

## Test Case
```yaml
- id: extract_data
  action: generate-structured
  parameters:
    prompt: "Extract data from this text"
    schema:
      type: object
      properties:
        items:
          type: array
          items:
            type: object
            properties:
              name: { type: string }
              value: { type: number }
        total:
          type: integer

- id: use_data
  action: generate
  parameters:
    prompt: |
      Total items: {{ extract_data.total }}
      {% for item in extract_data.items %}
      - {{ item.name }}: {{ item.value }}
      {% endfor %}
```

Currently: `extract_data` returns a string, causing template errors
Expected: `extract_data` returns structured data with accessible fields

## Workaround
Currently must parse JSON from string responses manually or use separate processing steps.

## Related
- Issue #172 (Iterative fact checker implementation)
- Issue #219 (While loop variables)
- Issue #220 (Filesystem template resolution)