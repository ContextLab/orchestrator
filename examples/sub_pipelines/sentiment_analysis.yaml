# Simple Sentiment Analysis Sub-Pipeline
id: sentiment_analysis
name: Sentiment Analysis Sub-Pipeline
description: Analyze sentiment in text data
version: "2.0.0"

parameters:
  data:
    type: object
    description: Input data with text to analyze
  text_column:
    type: string
    default: "comments"

steps:
  - id: analyze_sentiment
    action: generate_text
    parameters:
      prompt: |
        Analyze the sentiment of customer comments in this dataset.
        Look for the 'comments' column and analyze the first 10 unique comments.
        
        Data sample (first 500 chars): {{ inputs.data | default('{}') | string | truncate(500) }}
        
        Rate the overall sentiment on a scale of 1-5 and identify key themes.
        Return your analysis as JSON with keys: average_sentiment, positive_themes, negative_themes
      model: <AUTO>
      response_format: json
    
  - id: summarize_sentiment
    action: generate_text
    parameters:
      prompt: |
        Based on the sentiment analysis results:
        {{ analyze_sentiment.result | default('No sentiment data') }}
        
        Provide a brief summary of overall sentiment trends.
      model: <AUTO>
    dependencies:
      - analyze_sentiment

outputs:
  sentiment_scores: "{{ analyze_sentiment.result }}"
  sentiment_summary: "{{ summarize_sentiment.result }}"