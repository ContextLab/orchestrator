# Simple Trend Analysis Sub-Pipeline
id: trend_analysis
name: Trend Analysis Sub-Pipeline
description: Analyze trends in time series data
version: "2.0.0"

parameters:
  data:
    type: object
    description: Input time series data
  time_column:
    type: string
    default: "timestamp"
  value_columns:
    type: array
    default: ["sales", "revenue"]

steps:
  - id: analyze_trends
    action: generate_text
    parameters:
      prompt: |
        Analyze the following time series data for trends:
        
        Data: {{ inputs.data | default('{}') }}
        Time column: {{ inputs.time_column }}
        Value columns: {{ inputs.value_columns }}
        
        Identify:
        1. Overall trend direction (increasing/decreasing/stable)
        2. Any seasonal patterns
        3. Notable outliers or anomalies
        
        Return your analysis as a structured JSON object with keys: 
        trend_direction, seasonality, outliers, forecast_next_period
      model: <AUTO>
      response_format: json
    
  - id: create_forecast
    action: generate_text
    parameters:
      prompt: |
        Based on the trend analysis:
        {{ analyze_trends.result | default('{}') }}
        
        Provide a brief forecast for the next period.
      model: <AUTO>
    dependencies:
      - analyze_trends

outputs:
  trends: "{{ analyze_trends.result }}"
  forecasts: "{{ create_forecast.result }}"