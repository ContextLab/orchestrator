# Research Pipeline with Advanced Tools (Simplified)
# Uses specialized tools in a simpler way
id: research_advanced_tools_simple
name: Research Pipeline with Advanced Tools (Simplified)
description: Simplified advanced research pipeline that works with current system
version: "3.0.0"

parameters:
  topic:
    type: string
    default: "quantum computing applications"
  max_results:
    type: integer
    default: 10

steps:
  - id: search_topic
    tool: web-search
    action: search
    parameters:
      query: "{{topic}} latest developments 2024 2025"
      max_results: 10
      backend: "duckduckgo"
    
  - id: analyze_results
    action: analyze_text
    parameters:
      text: |
        Topic: {{topic}}
        
        Search Results:
        {% for result in search_topic.results %}
        {{ loop.index }}. {{ result.title }}
           URL: {{ result.url }}
           Snippet: {{ result.snippet }}
        {% endfor %}
      prompt: |
        Analyze these search results about {{topic}} and provide:
        1. The most credible and relevant sources (top 3-5)
        2. Key themes and developments
        3. Notable trends or breakthroughs
        4. Main applications mentioned
        
        Format as a structured analysis with clear sections.
      model: <AUTO task="analyze">Select model for analysis</AUTO>
    dependencies:
      - search_topic
    
  - id: generate_summary
    action: generate_text
    parameters:
      prompt: |
        Create a comprehensive executive summary for a research report on "{{topic}}" based on this analysis:
        
        {{analyze_results.result}}
        
        Requirements:
        - Length: 250-350 words
        - Professional, informative tone
        - Focus on latest developments and applications
        - Include specific examples where available
        - Start directly with the content
      model: <AUTO task="generate">Select model for summary</AUTO>
      max_tokens: 500
    dependencies:
      - analyze_results
    
  - id: generate_findings
    action: generate_text
    parameters:
      prompt: |
        Based on the research about {{topic}}, generate 5-7 key findings.
        Each finding should be a complete sentence that captures an important insight.
        
        Analysis:
        {{analyze_results.result}}
        
        Format as a numbered list.
      model: <AUTO task="generate">Select model for findings</AUTO>
      max_tokens: 300
    dependencies:
      - analyze_results
    
  - id: generate_recommendations
    action: generate_text
    parameters:
      prompt: |
        Based on the research about {{topic}}, provide 3-5 actionable recommendations.
        Each recommendation should be specific and forward-looking.
        
        Analysis:
        {{analyze_results.result}}
        
        Format as a bulleted list.
      model: <AUTO task="generate">Select model for recommendations</AUTO>
      max_tokens: 300
    dependencies:
      - analyze_results
    
  - id: compile_report
    action: generate_text
    parameters:
      prompt: |
        Create a properly formatted markdown research report by combining the following content. DO NOT add any new information or hallucinate content. Use ONLY the provided information:
        
        Topic: {{topic}}
        Search Results Count: {{search_topic.total_results}}
        
        Executive Summary:
        {{generate_summary.result}}
        
        Key Findings:
        {{generate_findings.result}}
        
        Detailed Analysis:
        {{analyze_results.result}}
        
        Recommendations:
        {{generate_recommendations.result}}
        
        Sources from search:
        {% for result in search_topic.results[:10] %}
        - {{result.title}} ({{result.url}})
        {% endfor %}
        
        Format this as a professional markdown report with:
        - Title: "Research Report: {{topic}}"
        - Current date/time header
        - All sections properly formatted
        - Sources as clickable markdown links
        - Footer noting it was generated by Advanced Research Pipeline
        
        IMPORTANT: Use ONLY the content provided above. Do not add any placeholder text or example content.
      model: <AUTO task="generate">Select model for report compilation</AUTO>
      max_tokens: 3000
    dependencies:
      - generate_summary
      - generate_findings
      - generate_recommendations
    
  - id: save_report
    tool: filesystem
    action: write
    parameters:
      path: "examples/outputs/research_advanced_tools/research_{{topic | slugify}}.md"
      content: "{{compile_report.result}}"
    dependencies:
      - compile_report

outputs:
  report_file: "{{save_report.filepath}}"
  search_count: "{{search_topic.total_results}}"
  summary: "{{generate_summary.result}}"