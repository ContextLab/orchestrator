name: test_while_minimal
description: Minimal version of control_flow_while_loop to debug iteration issue

inputs:
  target_number:
    type: integer
    default: 42
  max_attempts:
    type: integer 
    default: 1

steps:
  - id: initialize
    action: echo Starting game
    
  - id: guessing_loop
    while: 'true'
    max_iterations: "{{ max_attempts }}"
    steps:
      - id: generate_guess
        action: generate_text
        parameters:
          prompt: "Guess a number between 1 and 100"
          model: gemini-2.0-flash-lite
          max_tokens: 10
          
      - id: log_attempt
        tool: filesystem
        action: write
        parameters:
          path: "/tmp/minimal_loop_{{ guessing_loop.iteration }}.txt"
          content: "Iteration {{ guessing_loop.iteration }}"
    dependencies:
      - initialize
      
  - id: done
    action: echo Game complete
    dependencies:
      - guessing_loop