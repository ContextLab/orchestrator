name: test_while_simple_flow
description: Simplified control flow test without evaluate_condition

inputs:
  target_number:
    type: integer
    default: 42
  max_attempts:
    type: integer
    default: 1

steps:
  - id: init
    action: echo Starting with target {{ target_number }}
    
  - id: loop
    while: 'true'
    max_iterations: "{{ max_attempts }}"
    steps:
      - id: guess
        action: generate_text
        parameters:
          prompt: "Generate a number between 1 and 100. Reply with just the number."
          model: gemini-2.0-flash-lite
          max_tokens: 5
          
      - id: log
        tool: filesystem  
        action: write
        parameters:
          path: "/tmp/loop_iter_{{ loop.iteration }}.txt"
          content: |
            Iteration: {{ loop.iteration }}
            Guess: {{ guess.result }}
            Target: {{ target_number }}
            
  - id: final
    action: echo Completed after {{ loop.iterations | default(0) }} iterations
    dependencies: [loop]