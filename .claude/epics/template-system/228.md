---
name: While loop variables ($iteration) not available in templates
status: completed
created: 2025-08-21T21:14:03Z
updated: 2025-08-22T12:24:28Z
github: https://github.com/ContextLab/orchestrator/issues/228
imported: true
labels: bug, high-priority
---

# While loop variables ($iteration) not available in templates

**GitHub Issue:** [#219](https://github.com/ContextLab/orchestrator/issues/219)
**Status:** OPEN
**Labels:** bug, high-priority

## Description

## Problem
While loop variables like `$iteration` are not accessible in templates within loop steps, causing template syntax errors and preventing loops from functioning.

## Evidence
From iterative_fact_checker.yaml execution:
```
Error rendering template: unexpected char '$' at 6
Error type: TemplateSyntaxError
Error rendering template: '{% if $iteration == 1 %}'
```

## Impact
- Cannot use iteration number in file paths
- Cannot have conditional logic based on iteration
- While loops effectively unusable for iterative processing

## Expected Behavior
- `$iteration` should be available in all templates within loop steps
- Should resolve to current iteration number (1, 2, 3, etc.)
- Should work in both paths and content

## Test Case
```yaml
- id: test_loop
  while: "true"
  max_iterations: 3
  steps:
    - id: save_file
      tool: filesystem
      action: write
      parameters:
        path: "output/iteration_{{ $iteration }}.txt"
        content: "This is iteration {{ $iteration }}"
```

Should create files: iteration_1.txt, iteration_2.txt, iteration_3.txt

## Related
- Issue #172 (Iterative fact checker implementation)