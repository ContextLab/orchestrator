id: test-foreach-debug
name: Test For Each Debug
description: Debug for_each filesystem operations
version: "1.0.0"

parameters:
  items:
    type: array
    default: ["first", "second"]
    
steps:
  - id: prepare_data
    action: generate_text
    parameters:
      prompt: "Test data ready"
      model: "gpt-4o-mini"
      max_tokens: 10
      
  - id: process_items
    for_each: "{{ items }}"
    steps:
      - id: write_file
        tool: filesystem
        action: write
        parameters:
          path: "examples/outputs/control_flow_advanced/debug_{{ $item }}.txt"
          content: |
            Item: {{ $item }}
            Index: {{ $index }}
            Data from parent: {{ prepare_data.result }}
    dependencies:
      - prepare_data
      
outputs:
  message: "Debug completed"